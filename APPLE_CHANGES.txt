This contains the changes after creating `v3.4.1`

# From 4.0.0
SPARK-44661      `getMapOutputLocation` should not throw NPE
SPARK-42730      Update Spark Standalone Mode page
SPARK-44585      Fix warning condition in MLLib RankingMetrics ndcgAk
SPARK-44623      Upgrade `commons-lang3` to 3.13.0
SPARK-44707      Use INFO log in `ExecutorPodsWatcher.onClose` if `SparkContext` is stopped
SPARK-44726      Improve `HeartbeatReceiver` config validation error message
SPARK-44741      Support regex-based MetricFilter in `StatsdSink`
SPARK-44214      Support Spark Driver Live Log UI
SPARK-44916      Document Spark Driver Live Log UI
SPARK-44936      Simplify the log when Spark HybridStore hits the memory limit
SPARK-44993      Add `ShuffleChecksumUtils.compareChecksums` by reusing `ShuffleChecksumTestHelp.compareChecksums`
SPARK-44995      Promote `SparkKubernetesClientFactory` to `DeveloperApi`
SPARK-44996      Use `lazy val` for `DefaultVolcanoClient`
SPARK-45054      HiveExternalCatalog.listPartitions should restore partition statistics
SPARK-44915      Validate checksum of remounted PVC's shuffle data before recovery
SPARK-45145      Add JavaSparkSQLCli example
SPARK-45147      Remove `System.setSecurityManager` usage
SPARK-45174      Support `spark.deploy.maxDrivers`
SPARK-45322      Use ProcessHandle to get pid directly
SPARK-45404      Support `AWS_ENDPOINT_URL` env variables
SPARK-45423      Lower `ParquetWriteSupport` log level to debug
SPARK-45452      Improve `InMemoryFileIndex` to use `FileSystem.listFiles` API
SPARK-45500      Show `RELAUNCHING` drivers too
SPARK-45578      Remove `InaccessibleObjectException` usage by using `trySetAccessible`
SPARK-45500      Show the number of abnormally completed drivers in MasterPage
SPARK-45497      Add a symbolic link file `spark-examples.jar` in K8s Docker images
SPARK-45474      Support top-level filtering in MasterPage JSON API
SPARK-45462      Show `Duration` in `ApplicationPage`
SPARK-45452      Simplify path check logic
MINOR            Validate spark.deploy.defaultCores value during config setting
SPARK-45785      Support `spark.deploy.appNumberModulo` to rotate app number
SPARK-44843      Double streamingTimeout for StateStoreMetricsTest to make RocksDBStateStore related streaming tests reliable
SPARK-45774      Support `spark.master.ui.historyServerUrl` in `ApplicationPage`
SPARK-45777      Support `spark.test.appId` in `LocalSchedulerBackend`
SPARK-45771      Enable `spark.eventLog.rolling.enabled` by default
SPARK-45763      Improve `MasterPage` to show `Resource` column only when it exists
SPARK-45754      Support `spark.deploy.appIdPattern`
SPARK-45751      Update the default value for spark.executor.logs.rolling.maxRetainedFile
SPARK-45753      Support `spark.deploy.driverIdPattern`
SPARK-45749      Fix `Spark History Server` to sort `Duration` column properly
SPARK-45735      Reenable CatalogTests without Spark Connect
SPARK-45172      Upgrade `commons-compress` to 1.24.0
SPARK-45819      Support `clear` in REST Submission API
SPARK-45843      Support `killall` in REST Submission API
SPARK-45867      Support `spark.worker.idPattern`
SPARK-45756      Support `spark.master.useAppNameAsAppId.enabled`
SPARK-45731      Also update partition statistics with `ANALYZE TABLE` command
SPARK-45901      Collect and update `spark-standalone.md` with new confs

# From 3.5.0
SPARK-42396      Upgrade `Apache Kafka` to 3.4.0
SPARK-42536      Upgrade log4j2 to 2.20.0
SPARK-42718      Upgrade rocksdbjni to 7.10.2
SPARK-42761      Upgrade `kubernetes-client` to 6.5.0
SPARK-42764      Parameterize the max number of attempts for driver props fetcher in KubernetesExecutorBackend
SPARK-42769      Add `SPARK_DRIVER_POD_IP` env variable to executor pods
SPARK-42779      Allow V2 writes to indicate advisory shuffle partition size
SPARK-42794      Increase the lockAcquireTimeoutMs to 2 minutes for acquiring the RocksDB state store in Structure Streaming
SPARK-42808      Avoid getting availableProcessors every time in `MapOutputTrackerMaster#getStatistics`
SPARK-42833      Refactor `applyExtensions` in `SparkSession`
SPARK-42885      Upgrade `kubernetes-client` to 6.5.1
SPARK-43070      Upgrade `sbt-unidoc` to 0.5.0
SPARK-42382      Upgrade cyclonedx-maven-plugin to 2.7.5
SPARK-43483      Adds SQL references for OFFSET clause
SPARK-43281      Fix concurrent writer does not update file metrics
SPARK-43517      Add a migration guide for namedtuple monkey patch
SPARK-43527      Fix `catalog.listCatalogs` in PySpark
SPARK-43548      Remove workaround for HADOOP-16255
SPARK-43157      Clone InMemoryRelation cached plan to prevent cloned plan from referencing same objects
SPARK-43522      Fix creating struct column name with index of array
SPARK-43450      Add more `_metadata` filter test cases
Revert           SPARK-43313 Adding missing column DEFAULT values for MERGE INSERT actions
SPARK-43580      Add `https://dlcdn.apache.org/` to default_sites of get_preferred_mirrors
SPARK-43587      Run `HealthTrackerIntegrationSuite` in a dedicated JVM
SPARK-43842      Upgrade `gcs-connector` to 2.2.14
SPARK-36612      Support left outer join build left or right outer join build right in shuffled hash join
SPARK-44088      Remove `jdk.incubator.foreign` usage in Java 21
SPARK-44095      Make HiveExternalCatalogVersionsSuite skip old Spark versions on Java 21
SPARK-44092      Add `Utils.isJavaVersionAtLeast21` and make `core` module pass with Java 21
SPARK-44045      Mark `WholeStageCodegenSparkSubmitSuite` as `ExtendedSQLTest`
SPARK-44057      Mark all `local-cluster`-based tests as `ExtendedSQLTest`
SPARK-42369      Fix constructor for java.nio.DirectByteBuffer
SPARK-43876      Enable fast hashmap for distinct queries
SPARK-44139      Discard completely pushed down filters in group-based MERGE operations
SPARK-44138      Prohibit non-deterministic expressions, subqueries and aggregates in MERGE conditions
SPARK-43203      Move all Drop Table case to DataSource V2
SPARK-43975      DataSource V2: Handle UPDATE commands for group-based sources
SPARK-43963      DataSource V2: Handle MERGE commands for group-based sources
SPARK-44237      Simplify DirectByteBuffer constructor lookup logic
SPARK-44230      Make `sql` module passes in Java 21
SPARK-44183      Increate `PyArrow` minimum version to 4.0.0
SPARK-44153      Use JAVA_HOME and stderr
SPARK-43885      DataSource V2: Handle MERGE commands for delta-based sources
SPARK-44000      Add hint to disable broadcasting and replicating one side of join
SPARK-43959      Make RowLevelOperationSuiteBase and AlignAssignmentsSuite abstract
SPARK-43775      DataSource V2: Allow representing updates as deletes and inserts
SPARK-43324      Handle UPDATE commands for delta-based sources
SPARK-44294      Fix HeapHistogram column shows unexpectedly w/ select-all-box
SPARK-44215      If num chunks are 0, then server should throw a RuntimeException
SPARK-44313      Fix generated column expression validation when there is a char/varchar column in the schema
SPARK-44501      Ignore checksum files in KubernetesLocalDiskShuffleExecutorComponents
SPARK-44360      Support schema pruning in delta-based MERGE operations
SPARK-44392      Add tests for schema pruning in delta-basedUPDATEs
SPARK-44402      Add tests for schema pruning in delta-based DELETEs
SPARK-44534      Handle only shuffle files in KubernetesLocalDiskShuffleExecutorComponents
SPARK-44653      Non-trivial DataFrame unions should not break caching
SPARK-44588      Fix double encryption issue for migrated shuffle blocks
MINOR            Update concat and concat_ws documentation to point out unexpected behavior
SPARK-44641      Incorrect result in certain scenarios when SPJ is not triggered
MINOR            Fix incorrect link in sql menu and typo
SPARK-44990      Reduce the frequency of get `spark.sql.legacy.nullValueWrittenAsQuotedEmptyStringCsv`
SPARK-44034      Add a new test group for sql module
SPARK-45389      Correct MetaException matching rule on getting partition metadata
SPARK-42388      Avoid parquet footer reads twice in vectorized reader

# From 3.4.2
SPARK-44670      Fix 'test_dataframe_conversion.DataFrameConversionTest.get_excel_dfs' test to work with Python 3.7
SPARK-44634      Encoders.bean does no longer support nested beans with type arguments
SPARK-44657      Fix incorrect limit handling in ArrowBatchWithSchemaIterator and config parsing of CONNECT_GRPC_ARROW_MAX_BATCH_SIZE
SPARK-44725      Document `spark.network.timeoutInterval`
SPARK-44581      Fix the bug that ShutdownHookManager gets wrong UGI from SecurityManager of ApplicationMaster
SPARK-44745      Document shuffle data recovery from the remounted K8s PVCs
SPARK-44813      The Jira Python misses our assignee when it searches users again
SPARK-44875      Fix spelling for commentator to test SPARK-44813
SPARK-44857      Fix `getBaseURI` error in Spark Worker LogPage UI buttons
SPARK-44859      Fix incorrect property name in structured streaming doc
SPARK-44854      Python timedelta to DayTimeIntervalType edge case bug
SPARK-44871      Fix percentile_disc behaviour
SPARK-44922      Disable o.a.p.h.InternalParquetRecordWriter logs for tests
SPARK-44925      K8s default service token file should not be materialized into token
SPARK-44920      Use await() instead of awaitUninterruptibly() in TransportClientFactory.createClient()
SPARK-44935      Fix `RELEASE` file to have the correct information in Docker images if exists
SPARK-44929      Standardize log output for console appender in tests
SPARK-44840      Make `array_insert()` 1-based for negative indexes
SPARK-44547      Ignore fallback storage for cached RDD migration
SPARK-44846      Convert the lower redundant Aggregate to Project in RemoveRedundantAggregates
SPARK-44940      Improve performance of JSON parsing when "spark.sql.json.enablePartialResults" is enabled
SPARK-45071      Optimize the processing speed of `BinaryArithmetic#dataType` when processing multi-column data
SPARK-45079      Fix an internal error from `percentile_approx()`on `NULL` accuracy
SPARK-45103      Update ORC to 1.8.5
SPARK-45100      Fix an internal error from `reflect()`on `NULL` class and method
SPARK-43203      V2SessionCatalog.dropTable should handle null table
SPARK-44805      getBytes/getShorts/getInts/etc. should work in a column vector that has a dictionary
SPARK-45075      Fix alter table with invalid default value will not report error
SPARK-45109      Fix log function in Connect
SPARK-45146      Update the default value of 'spark.submit.deployMode'
SPARK-45127      Exclude README.md from document build
SPARK-45187      Fix `WorkerPage` to use the same pattern for `logPage` urls
SPARK-45197      Make `StandaloneRestServer` add `JavaModuleOptions` to drivers
SPARK-45229      Show the number of drivers waiting in SUBMITTED status in MasterPage
SPARK-45078      Fix `array_insert` ImplicitCastInputTypes not work
SPARK-45081      Encoders.bean does no longer work with read-only properties
SPARK-44910      Encoders.bean does not support superclasses with generic type arguments
SPARK-45210      Switch languages consistently across docs for all code snippets (Spark 3.4 and below)
SPARK-45237      Change the default value of `spark.history.store.hybridStore.diskBackend` in `monitoring.md` to `ROCKSDB`
SPARK-45261      Fix `EventLogFileWriters` to handle `none` as a codec
SPARK-45263      Make `EventLoggingListenerSuite` independent from `spark.eventLog.compress` conf
SPARK-45261      Avoid `transform` of conf value
SPARK-45257      Enable `spark.eventLog.compress` by default
SPARK-45286      Add back Matomo analytics
SPARK-44937      Mark connection as timedOut in TransportClient.close
SPARK-45057      Avoid acquire read lock when keepReadLock is false
SPARK-45227      Fix a subtle thread-safety issue with CoarseGrainedExecutorBackend
SPARK-44074      Fix loglevel restore behavior of `SparkFunSuite#withLogAppender` and re-enable UT `Logging plan changes for execution`
SPARK-45452      Do not fail too early if FileSystem does not implement getSchema
SPARK-45652      SPJ: Handle empty input partitions after dynamic filtering
SPARK-45678      Cover BufferReleasingInputStream.available/reset under tryOrFetchFailedException 
SPARK-45604      Add LogicalType checking on INT64 -> DateTime conversion on Parquet Vectorized Reader
SPARK-45430      Fix for FramelessOffsetWindowFunction when IGNORE NULLS and offset > rowCount
SPARK-45588      Fix flaky ProtobufCatalystDataConversionSuite
SPARK-40154      Correct storage level in Dataframe.cache docstring
SPARK-45670      SparkSubmit does not support `--total-executor-cores` when deploying on K8s
MINOR            Remove signature from Hive thriftserver exception
SPARK-45568      Fix flaky WholeStageCodegenSparkSubmitSuite
SPARK-45508      Add "--add-opens=java.base/jdk.internal.ref=ALL-UNNAMED" so Platform can access Cleaner on Java 9+
SPARK-45433      Fix CSV/JSON schema inference when timestamps do not match specified timestampFormat
SPARK-45473      Fix incorrect error message for RoundBase
SPARK-44729      Add canonical links to the PySpark docs page
MINOR            Update `CTAS` with `LOCATION` behavior with Spark 3.2+
SPARK-45786      Fix inaccurate Decimal multiplication and division results
SPARK-45829      Update the default value for spark.executor.logs.rolling.maxSize
SPARK-45814      Make ArrowConverters.createEmptyArrowBatch call close() to avoid memory leak
SPARK-45847      CliSuite flakiness due to non-sequential guarantee for stdout&stderr
SPARK-45878      Fix ConcurrentModificationException in CliSuite
SPARK-45884      Upgrade ORC to 1.8.6
MINOR            Fix the example value in the docs
SPARK-45592      Correctness issue in AQE with InMemoryTableScanExec
SPARK-45282      Correctness issue in AQE with InMemoryTableScanExec
SPARK-45896      Construct `ValidateExternalType` with the correct expected type

# Internal Patches
MINOR            Add rio.yml and dev scripts
MINOR            Adjust test cases for RIO
MINOR            Bump to 3.4.0.1-apple-SNAPSHOT
SPARK-17767      Support user-provided ExternalCatalog and SessionBuilder
rdar://64257964  Add back http support so it works without hadoop configuration
rdar://68926116  Add alternative conf name `spark.FsUrlStreamHandlerFactory.enabled`
rdar://66576657  Add spark-avro to the tgz build to simplify kernels
rdar://82806227  Support Apple repo in DependencyUtils for Ivy
rdar://82183532  Support CachedS3AFileSystem for S3
rdar://82423473  Support `spark.sql.files.s3c.enabled` conf
rdar://89567863  Add parquet footer cache feature in SMC
rdar://104445096 Apply internal configurations
rdar://72552554  Increase DEFAULT_MAX_CONSECUTIVE_STAGE_ATTEMPTS from 4 to 6
MINOR            Use zstd as default compression codec
MINOR            Support JarvisSparkHadoopUtil
MINOR            Use Utils.localHostName() for bindAddress
rdar://71819374  Bridge in LZO codec family
rdar://91548932  Update log4j1 dependency detection for log4j2 2.17.2
rdar://90787805  Make spark driver endpoints extensible to be used by awsappleconnect-spark-utils
rdar://103524012 Adding color from spark plan UI block depending on inner text
rdar://100580258 Upgrade Hive to 2.3.9.4-apple
rdar://70562690  Update kubernetes Dockerfile to AppleJDK
rdar://82095645  Integrate ACI spark call home service listener
MINOR            Forward port multiple containers and shuffle service from ACS 3.0
rdar://99714991  Support configuring version of the PME Key to use for writing
rdar://101964650 Enable Dependency Test
rdar://105024624 Set `spark.sql.autoBroadcastJoinThreshold` to 100MB
rdar://104835338 Add bump-version.sh (#1670)
rdar://79590736  Extend 'k8sRegex' to accept 'aci-k8s'
MINOR            Fix ExternalShuffleSidecarSuite compilation error
rdar://105590919 Use ubuntu:jammy in Dockerfile
rdar://105739324 Build PySpark Package
rdar://106124632 Enable hive profile for `connect` module test
rdar://106365381 Bump Parquet to 1.12.3.3-apple
rdar://106150608 Bump Hadoop to 3.3.4.3-apple (#1697)
rdar://106670519 Add Boson version 0.3.0 in Spark-3.4 (#1714)
rdar://107596423 Add BosonSort handling in JoinSuite (#1725)
rdar://92996732  Use quoted identifier for column name 'date' before pushing filter to UC (#1412)
rdar://107856276 Disable shuffle service sidecar feature
rdar://107970457 Bump Boson to 0.3.1 (#1733)
rdar://108296516 [Boson] handle BosonFilter in stripSparkFilter
rdar://108592695 [Boson] Bump Boson version to 0.3.2 in Spark
rdar://109188323 [Boson] Enable Boson scan in Spark 3.4 by default (#1754)
rdar://109549054 Bump Boson version to 0.3.5 (#1759)
rdar://110070310 Bump Hive version to 2.3.9.6-apple (#1766)
rdar://110133417 Bump Boson version to 0.3.9 (#1768)
rdar://110553017 [Boson] Update version to 0.3.11 (#1779)
rdar://110658365 Check whether mvn bumps versions correctly (#1782)
rdar://110874630 Bump Boson to 0.3.12 (#1795)
SPARK-44110      Propagate proxy settings to forked JVMs
SPARK-44153      Support `Heap Histogram` column in `Executors` tab
SPARK-44147      Add `spark.ui.allowFramingFrom` doc to `Security` page
rdar://99333529  (Job Insights: Tune based on cpu/mem/disk underutilization of pods)
SPARK-43204      Align MERGE assignments with table attributes
SPARK-43268      Use proper error classes when exceptions are constructed with a message
rdar://111110273 Add InMemoryStore.getData method to support internal history server
SPARK-42151      Align UPDATE assignments with table attributes
rdar://84031512  Add stored procedure API (#1801)
SPARK-43088      Respect RequiresDistributionAndOrdering in CTAS/RTAS
SPARK-42855      Use runtime null checks in TableOutputResolver
SPARK-42997      TableOutputResolver must use correct column paths in error messages for arrays and maps
SPARK-44125      Support Java 21 in SparkR
SPARK-44122      Make `connect` module pass except Arrow-related ones in Java 21
SPARK-44099      Support both java-8-openjdk-amd64 and java-8-openjdk-arm64 in `spark-rm` Dockerfile
rdar://110667736 Include CLASSES.csv file in Apple spark tarball
rdar://111235765 Create Table and Alter Table with Distribution Port to 3.4 (#1808)
rdar://111955881 Differentiate Create Table Unordered from Create Table default (#1810)
rdar://111985992 Upgrade Parquet to 1.13.1.1-apple (#1811)
rdar://112211550 Add spark-connect library to binary distribution
rdar://112203854 Update Boson version to 0.3.13 (#1815)
rdar://112293760 Add Iceberg 1.3.0.0-apple To Spark 3.4 Apple (#1818)
rdar://112293760 Bump Iceberg to 1.3.0.1-apple (#1823)
rdar://112325953 Add Rio pipeline to run iceberg unit tests for branch-3.4.0 (#1819)
rdar://112431669 Auto load Iceberg extensions (#1805)
rdar://112325953 Add Rio pipeline to run iceberg unit tests for branch-3.4.0
rdar://112620764 Add a debug log to DiskStore.moveFileToBlock (#1829)
rdar://112692714 (Bump Iceberg to 1.3.0.2-apple) (#1828)
rdar://112767815 Upgrade Parquet version to 1.13.1.2-apple for ACS Spark 3.4 (#1830)
rdar://113050231 [Boson] Bump Boson version to 0.3.14 in Spark (#1833)
rdar://113352087 Fix artifact filter for publishing images
rdar://113060247 Publish images for snapshot and release builds
rdar://113641362 Avoid artifactory redirects for snapshot distributions
rdar://110127648 Upgrade callhome service to 0.2.29
rdar://113772991 Update Boson to 0.3.15
rdar://113767905 Update Iceberg to 1.3.0.3-apple
rdar://113781872 Enable BosonShuffleManager in Spark 3.4
rdar://112799075 Async profiler support
rdar://113781872 Remove BosonConf dependency from core by using string config names
rdar://114672798 Don't load Boson jar in Spark unless Boson is enabled (#1850)
rdar://114854895 Bump Boson to 0.3.18 (#1854)
rdar://112799075 enable async_profiler in build
rdar://114213400 Bump spark-call-home-listener to 0.2.31
rdar://115803725 Enable Magic Committer by default in Team-shared Spark Cluster
rdar://115843507 Bump Boson to 0.3.19
rdar://115848005 Potential Image build failure due to changes in RIO_CONTEXT_FILE
rdar://115883001 Increase Python test parallelism to 3
rdar://115909994 Updates Iceberg to Apple 1.3.0.4
rdar://116016436 Remove hadoop-2 dependency check
rdar://116440884 Use S3AFileSystem for 's3://' in Team-shared Spark Cluster
rdar://116631249 Set spark.sql.sources.useListFilesFileSystemList=s3,s3a in Team-shared Spark Cluster
rdar://117273662 Update Boson to 0.3.20 (#1865)
rdar://117157873: Fatal error (e.g. OOM) during generating streaming jobs should fail the streaming context (#1864)
rdar://117158009 Update stripSparkFilter test method for Boson (#1863)
rdar://116895470 Set spark.hadoop.mapreduce.outputcommitter.factory.scheme.s3 in Team-shared Spark Cluster
rdar://116895388 Set spark.hadoop.fs.s3a.bulk.delete.page.size to 1000 in Team-shared Spark Cluster
rdar://117590641 Bump Boson version to 0.3.21 (#1871)
rdar://117948760 Bump Boson version to 0.3.22 (#1874)
rdar://117967381 Increase spark.speculation.quantile and multiplier
rdar://118061020 Remove legacy `spark.aci.callhome.enabled` config
